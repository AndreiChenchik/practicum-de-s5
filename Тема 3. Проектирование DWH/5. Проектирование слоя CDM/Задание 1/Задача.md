# Тема 3. Урок 6. Задание 1. #

## Задание

Напишите запрос для создания витрины для взаиморасчётов с ресторанами. Таблица должна находиться в схеме `cdm` и называться `dm_settlement_report`.

Посчитанные за прошлые периоды данные не будут меняться, поэтому используйте таблицу.

Описание полей, которые мы хотим получить в витрине:

| Поле | Какие данные содержит |
| --- | --- |
| id | Идентификатор записи. |
| restaurant_id | Идентификатор ресторана. |
| restaurant_name | Название ресторана. |
| settlement_year | Год отчёта. |
| settlement_month | Месяц отчёта, где 1 - январь, 12 - декабрь. |
| orders_count | Количество заказов. |
| orders_total_sum | Общая сумма заказов. Т.е. сумма платежей клиентов. |
| orders_bonus_payment_sum | Сумма оплат бонусами. |
| orders_bonus_granted_sum | Сумма накопленных бонусов. |
| order_processing_fee | Сумма, удержанная компанией за обработку заказов. |
| restaurant_reward_sum | Сумма, которую необходимо перечислить ресторану. |

Необходимые типы данных:

- `serial` для идентификатора записи
- `integer` идентификатора ресторана и количества заказов
- `varchar` для названия ресторана
- `numeric(14, 2)` для всех полей с суммой оплат и бонусами
- `smallint` для периодов отчёта
- Добавьте ограничение `NOT NULL` на все поля, так как ваша витрина не будет корректной, если хоть одно значение будет `nullable`. Пока не создавайте другие ограничения, вы сделаете это в следующем упражнении.


Сохраните полученный код в realization.sql и запустите тест.

---

## Тесты

Для запуска тестов используйте файл `submit.py` в текущей директории.

